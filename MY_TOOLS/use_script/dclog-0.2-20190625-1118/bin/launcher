#!/bin/bash

DATE=$(date +%Y%m%d)
UUID=$(cat /proc/sys/kernel/random/uuid)

cd `dirname $0`
cd ..
CDIR=`pwd`

#if [ -n "$1" ] ;then
#  vars_path=$1
#else
vars_path='./bin/vars'
#fi

if [ -f "$vars_path" ]; then
. $vars_path
fi

logPath=$prj_log_home
# echo $logPath

if [ ! -d "$logPath" ]; then
  mkdir -p "$logPath"
fi

filePath=$logPath/files

if [ ! -d "$filePath" ]; then
  mkdir -p "$filePath"
fi
hourPath=$logPath/hourss
if [ ! -d "$hourPath" ]; then
  mkdir -p "$hourPath"
fi

export dc_filepath=$filePath
export dc_home=$prj_home

python $CDIR/collector.py my_rnd=$UUID >$logPath/console.log 2>&1 &
# python $CDIR/collector2.py my_rnd=$UUID >$logPath/console.log 2>&1 &

sleep 2s

echo $(ps -ef|grep "$UUID"|grep -v grep|awk '{print $2}') > $logPath/pidfile
